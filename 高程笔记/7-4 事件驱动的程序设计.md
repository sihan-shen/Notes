
## 主要内容
- Windows与事件驱动的程序设计
- 基于Windows API的过程式的事件驱动程序设计
- 面向对象的事件驱动程序设计
- 基于应用框架的事件驱动程序设计

## Windows简介
- 基于图形界面的多任务操作系统
- 系统中可以同时运行多个程序
- 每个程序通过各自的"窗口"与用户进行交互
- Windows功能提供方式：
  - 工具：资源管理器、记事本、画图等
  - 函数库：以C语言函数形式出现（Windows API）

## 事件驱动的程序结构
- 程序动作由事件激发
- 事件类型：
  - WM_KEYDOWN/WM_KEYUP（键盘按键）
  - WM_CHAR（字符）
  - WM_LBUTTONDOWN/WM_LBUTTONUP/WM_LBUTTONDBLCLK/WM_MOUSEMOVE（鼠标按键）
  - WM_COMMAND（菜单选取）
  - WM_PAINT（窗口内容刷新）
  - WM_TIMER（定时器消息）

## 消息处理机制
- 每个应用程序都有一个消息队列
- 消息循环过程："取消息-处理消息"
- 每个窗口都有一个消息处理函数
- 注意事项：消息处理时间不宜过长，否则会造成程序"假死"

## Windows应用程序的类型
1. 单文档应用
   - 只能对一个文档的数据进行操作
   - 必须完成当前文档操作才能进行下一个
2. 多文档应用
   - 可同时对多个文档数据进行操作
   - 在不同子窗口中进行操作
3. 对话框应用
   - 以对话框形式操作文档数据
   - 通过"控件"实现操作

## 基于Windows API的事件驱动程序设计
### WinMain函数功能
1. 注册窗口类
   - 定义窗口类型：风格、消息处理函数、图标等
2. 创建应用程序主窗口
3. 进入消息循环（直到接收到WM_QUIT消息）

### 代码结构
```c
WinMain(...)
{
    RegisterClass(...);  // 注册窗口类
    CreateWindow(...);   // 创建主窗口
    while (GetMessage(...))  // 消息循环
    {
        DispatchMessage(...);  // 处理消息
    }
}

// 消息处理函数
WindowProc(...,message,...)
{
    switch(message)
    {
        case ...:
        case ...:
        ...
    }
}
```

### 资源（Resource）
- 包含菜单、对话框等
- 存储在资源文件(.rc)中
- 可用VC++资源编辑器进行可视化编辑

## 面向对象的事件驱动程序设计
### Windows应用程序中的对象
1. 窗口对象
   - 显示处理数据
   - 处理Windows消息
   - 可存在继承和组合关系
2. 文档对象
   - 管理窗口显示和处理的数据
   - 与窗口对象存在关联关系
3. 应用程序对象
   - 管理窗口和文档对象
   - 实现消息循环
   - 构成组合关系

### 支持Windows应用开发的类库
- 微软的MFC：封装Windows API
- Qt：跨平台，不需要了解底层细节

## 应用框架
- 通用的、可复用的应用程序结构
- 规定了程序组件及其关系
- 封装程序处理流程控制逻辑
- 常见框架：
  - 基于MFC的"文档-视"结构
  - 基于Qt的"模型-视"结构