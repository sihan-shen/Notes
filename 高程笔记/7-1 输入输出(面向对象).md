
## 输入/输出概述
- I/O是程序重要组成部分：
  - 程序运行所需数据通常来自外设（键盘、文件等）
  - 程序运行结果通常输出到外设（显示器、打印机、文件等）
- C++中I/O是基于字节流的操作：
  - 输入：数据逐个字节从外设流入内存
  - 输出：数据逐个字节从内存流出到外设

## C++输入输出实现途径
1. 过程式（C语言保留）
   - printf, scanf等函数
2. 面向对象（C++ I/O类库）
   - ostream、cout、<<
   - istream、cin、>>

### printf和scanf的缺陷
- 不是强类型：编译时不进行类型检查
- 格式串与实际数据类型不一致会导致运行时错误
- 参数个数不一致也会导致错误

### cout和cin的优势
- 无需单独指定数据类型和个数
- 编译时根据数据本身决定操作类型和个数
- 避免类型和个数相关错误

## I/O分类
1. 面向控制台的I/O
   - 标准输入设备（键盘）
   - 标准输出设备（显示器）
2. 面向文件的I/O
   - 外存文件读写
3. 面向字符串变量的I/O（已被STL string替代）

## C++ I/O类库基本类
- 通过创建I/O类对象进行字节流操作
- 示例：
  ```cpp
  istream in(...);
  in.get(ch); // 读入一个字节
  in.read(p,100); // 读入100个字节
  
  ostream out(...);
  out.put(ch); // 输出一个字节
  out.write(p,100); // 输出100个字节
  ```

## 面向控制台的I/O
### 预定义对象
- cin（istream类）：标准输入设备（键盘）
- cout（ostream类）：标准输出设备（显示器）
- cerr/clog（ostream类）：错误信息输出（显示器）
- 需要包含头文件：`#include <iostream>`

### 控制台输出操作
- 使用`<<`操作符输出基本数据类型
- 输出格式控制：
  - 包含头文件：`#include <iomanip>`
  - 使用操纵符（如hex、endl等）

### 常用输出操纵符
- hex：十六进制输出
- endl：换行
- setprecision：设置浮点数精度

### 控制台输入操作
- 使用`>>`操作符输入基本数据类型
- 数据间用空白符分隔
- 可使用操纵符控制输入行为（如setw）

## 操作符重载
### `<<`操作符重载
```cpp
class A {
    int x,y;
public:
    friend ostream& operator<<(ostream& out, const A &a);
};
ostream& operator<<(ostream& out, const A &a) {
    out << a.x << ',' << a.y;
    return out;
}
```

### 派生类输出操作符实现
1. 直接重载：
   ```cpp
   ostream& operator<<(ostream& out, const B& b) {
       out << (A&)b << ',' << b.z;
       return out;
   }
   ```
2. 使用虚函数：
   ```cpp
   virtual void display(ostream& out) const {
       out << x << ',' << y;
   }
   ```

## 面向文件的I/O
### 文件基本概念
- 流式文件：由一系列字节构成的字节串
- 文件位置指针：指示当前读写位置

### 文件读写过程
1. 打开文件
2. 文件读写
3. 关闭文件

### 文件数据存储方式
1. 文本方式
   - 包含可显示字符和控制字符
   - 可用记事本查看
2. 二进制方式
   - 包含任意二进制字节
   - 由应用程序解释

### 文件操作头文件
```cpp
#include <iostream>
#include <fstream>
```

### 文件输出操作
1. 打开文件：
   ```cpp
   ofstream out_file("filename", ios::out);
   // 或
   ofstream out_file;
   out_file.open("filename", ios::out);
   ```
2. 打开方式：
   - ios::out：默认，清除已有内容
   - ios::app：追加，不清除内容
   - ios::binary：二进制方式
3. 判断打开成功：
   ```cpp
   if (!out_file.is_open()) { ... }
   ```
4. 输出数据：
   - 文本方式：`out_file << data;`
   - 二进制方式：`out_file.write((char*)&data, sizeof(data));`
5. 关闭文件：`out_file.close();`

### 文件输入操作
1. 打开文件：
   ```cpp
   ifstream in_file("filename", ios::in);
   // 或
   ifstream in_file;
   in_file.open("filename", ios::in);
   ```
2. 输入数据：
   - 文本方式：`in_file >> data;`
   - 二进制方式：`in_file.read((char*)&data, sizeof(data));`
3. 判断读取成功：`in_file.fail()`
4. 关闭文件：`in_file.close();`

### 文件读写注意事项
- 文本方式输入输出要对应
- 二进制方式输入输出要对应
- 二进制方式不利于兼容性和可移植性

### 双向文件操作
- 使用fstream类
- 打开方式：
  - ios::in|ios::out：任意位置写
  - ios::in|ios::app：末尾写

### 文件随机存取
- 读指针操作：
  - seekg：设置读位置
  - tellg：获取读位置
- 写指针操作：
  - seekp：设置写位置
  - tellp：获取写位置
- 参照位置：
  - ios::beg：文件头
  - ios::cur：当前位置
  - ios::end：文件尾