## 关系的闭包和等价

### 关系的闭包

#### 闭包的一般概念
- 设R是集合A上的关系，P是给定的某种性质（如：自反、对称、传递）
- 满足下列所有条件的关系R1称为R的关于P的闭包:
  - R⊆R1 
  - R1满足性质P 
  - 如果存在集合A上的关系R’，R’满足性质P并包含R，则R1⊆R’
- 自反闭包r(R)、对称闭包s(R)、传递闭包t(R)

#### 自反闭包
- 定义：r(R)满足自反性；R⊆r(R); 对任意自反关系R’包含R，有r(R)⊆R’
- 计算公式：r(R) = R∪IA（IA是集合A上的恒等关系）

#### 对称闭包
- 定义：s(R)满足对称性；R⊆s(R); 对任意对称关系R’包含R，有s(R)⊆R’
- 计算公式：s(R) = R∪R⁻¹

#### 传递闭包
- 定义：t(R)满足传递性；R⊆t(R); 对任意传递关系R’包含R，有t(R)⊆R’
- 计算公式：t(R) = R*（连通关系）
  - R* = R¹∪R²∪R³∪... = ⋃_{k=1}^∞ Rᵏ
  - 对于有限集合A(|A|=n)，t(R) = R¹∪R²∪...∪Rⁿ

#### 闭包的性质
- r(s(R)) = s(r(R))
- t(s(R)) ⊆ s(t(R))
- 传递关系的对称闭包不一定是传递的

#### 传递闭包的计算
- 矩阵乘法法：M_t(R) = M_R ∨ M_R² ∨ ... ∨ M_Rⁿ
- Warshall算法：
  - 时间复杂度：O(n³)
  - 算法步骤：
    ```
    1. W := M_R
    2. FOR k :=1 to n
        FOR i :=1 to n
            FOR j :=1 to n
                W[i,j] := W[i,j] ∨ (W[i,k] ∧ W[k,j])
    3. Output W
    ```

### 等价关系

#### 定义
- 满足性质：自反、对称、传递
- "等于"关系的推广

#### 等价类
- 定义：[x]R = {y | y∈A ∧ xRy}
- 性质：
  - 每个等价类是A的非空子集
  - 若xRy，则[x]R = [y]R
  - 等价类的每个元素都可以做代表元素

#### 商集
- 定义：A/R = {[x]R | x∈A}
- 性质：商集是集合A的一个划分

#### 划分
- 定义：集合A的划分π是A的一组非空子集的集合，满足：
  1. A = ⋃Aᵢ
  2. 对任意i≠j，Aᵢ∩Aⱼ=∅
- 等价关系与划分的对应：
  - 每个等价关系对应一个划分（商集）
  - 每个划分对应一个等价关系（属于同一划分块的关系）

#### 例子
1. 对3同余关系：
   - 等价类：[0]={...,-6,-3,0,3,6,...}, [1]={...,-5,-2,1,4,...}, [2]={...,-4,-1,2,5,...}
2. 自然数集笛卡尔积上的关系：
   - (a,b)R(c,d)当且仅当a+d=b+c
   - 这是一个等价关系
3. 乘积集合上的关系：
   - (x1,x2)S(y1,y2)当且仅当x1R1y1且x2R2y2
   - 若R1,R2是等价关系，则S也是等价关系

### 应用
- 鸽笼原理应用：
  - 从1,2,...,2000中任取1001个数，必有两个数x,y满足x/y=2ᵏ
  - 证明方法：建立等价关系xRy当且仅当x/y=2ᵏ，形成1000个等价类