
## 第一讲 时序逻辑电路概述

### 1 时序逻辑电路概述
- 组合逻辑：输出结果仅取决于当前的输入信号
- 时序逻辑：输出结果不仅取决于当前时刻的输入值，而且取决于电路过去时刻的行为（当前状态）
  - 电路中有存储元件，用于存储逻辑信号的值，表示电路过去时刻的行为（当前状态）
  - 当电路输入值发生变化时，新的输入值可能使得电路保持当前状态，也可能使得电路状态发生改变，进入新的状态
  - 例如报警系统就是一种时序逻辑

### 1.1 时序逻辑与有限状态机
- 有限状态机（Finite State Machine，FSM）是一种刻画状态以及状态转换的理论工具
- 通常用状态图描述有限状态机
  - 状态：用包含状态符号的圆圈表示
  - 状态转换方向：用有向边表示，并在边上标注引起状态变换的输入信号值和相应输出响应（若输出响应只与当前状态有关，则把输出响应标注在状态圆圈中）
- 例：检测输入序列是否为连续4个"1"
  - A-初始态：若输入1，则转B
  - B-连续1个"1"：若输入1，则转C
  - C-连续2个"1"：若输入1，则转D
  - D-连续3个"1"：若输入1，则状态不变并输出为1（表示检测到连续4个1）
  - 任何状态下，输入0都会转到初态A

- 用数字逻辑实现一个有限状态机，需要完成的主要工作：
  1. 把状态机的输入、输出以及内部状态都转换成二进制表示
  2. 设计实现一种电路能进行状态的记忆
  3. 设计出符合状态转换逻辑要求的状态记忆器件的激励函数和输出函数，并完成定时分析

### 1.2 时序逻辑电路基本结构
- 时序逻辑电路的一般结构
  - 状态记忆模块：由多个状态记忆单元构成
  - 次态激励逻辑模块F：激励函数（现态和外部输入的逻辑函数）
  - 输出逻辑模块G：输出函数（现态和外部输入的逻辑函数）
- 类型：
  - Mealy型：输出依赖于当前状态和当前输入信号
  - Moore型：输出仅依赖于当前状态，和当前输入信号无关
- 根据状态转换方式的不同：
  - 同步时序逻辑电路：在统一的时钟信号控制下进行状态转换
  - 异步时序逻辑电路：没有统一的时钟信号来控制状态的改变

### 1.3 时序逻辑电路的定时
- 什么时候状态会发生变换？电平触发或边沿触发
- 时序逻辑电路的状态多采用边沿触发方式
  - 边沿触发方式分为上升沿触发和下降沿触发两种类型
- 时钟周期
- 时钟频率=1/时钟周期

## 第二讲 锁存器和触发器

### 2.1 双稳态元件
- 用于存储1位二进制数据，有两个互补的输出状态
  - 状态1：置位(Set)状态，表示存储逻辑"1"
  - 状态0：复位(Reset)状态，Q为低电平，表示存储逻辑"0"
- 双稳态元件的简单实现
  - 串联两个反相器，则反相器的输出状态不同，且保持稳定
  - Q为高电平时，为置位状态；Q为低电平时，为复位状态
- 用两个反相器串联构建的双稳态元件，由于无法改变电路的状态，因此功能受到限制
- 根据存储元件触发方式的不同，分成两种类型：
  - 电平触发：锁存器(latch)
  - 边沿触发：触发器(flip-flop)

### 2.2 SR锁存器
- SR锁存器：使用一对交叉耦合的或非门构成双稳态电路，也称为置位-重置（复位）锁存器
  - S是置位输入端，R是重置输入端
- 状态图、状态表、特征方程之间可相互转换
- 功能：SR锁存器常用来设置标志位

### 2.3 D锁存器
- 如何利用锁存器来设置、储存信息位？
  - D = 1时，Q = 1
  - D = 0时，Q = 0
- 只有一个数据输入端D，称为D锁存器，也称为透明锁存器
- 特征方程：Q* = D（C=1）

### 2.4 D触发器
- 由一对主、从D锁存器构成
  - 从锁存器只在时钟CLK的上升沿到来时采样主锁存器的输出QM的值，并确定Q和QN的输出
- D触发器特征方程: Q* = D
- 定时参数：
  - 锁存延迟tCQ（latch prop)
  - 建立时间tsetup
  - 保持时间thold
- 带使能端的D触发器
- 具有预置和清零（复位）端的D触发器

### 2.5 边沿触发式J-K触发器
- 在上升沿时采样输入信号

### 2.6 T触发器
- T触发器：在每个时钟脉冲的触发边沿都会改变状态
- 基于D触发器实现；可用于实现计数器、分频器等功能

## 第三讲 同步时序逻辑设计

### 3.1 同步时序逻辑设计步骤
1. 将文字描述逻辑抽象为数字设计模型
2. 根据数字设计模型构建原始状态图/表
3. 合并等价状态对，减少状态数量
4. 每个状态赋予一个二进制编码
5. 根据编码得到次态函数、激励函数和输出函数
6. 能否自启动，是否进入挂起

### 3.2 状态图/状态表设计
- 状态图/状态表设计：分析系统内部的状态转换关系
- 例：设计一个能检测出一连串外部输入中是否出现了0/1序列"101"的状态机
- 构建状态图/表步骤：
  1. 设定任一状态为电路初始状态
  2. 从初始状态开始，分析每一个状态在不同输入作用下的状态转移情况和输出取值
  3. 如果某状态下出现的输出响应（次态、输出）不能用已有状态表示，则产生新的状态
  4. 重复第2、3步，直到不产生新状态为止

### 3.3 状态化简和状态编码
- 状态化简
  - 合并等价状态，以得到更加精简的状态表
  - 两个状态等价指在所有输入组合下，它们的输出相同且次态相同或次态等价
- 状态编码
  - 对状态表中每个状态赋予唯一的二进制编码，也称状态赋值
  - 通常在具体设计时采用相邻法寻求次优编码方案

### 3.4 电路设计与分析
- 在选定的状态编码方案基础上进行电路设计
- 生成状态转移表
- 电路分析：包括未用状态分析和电路定时分析等
- 电路定时分析
  - 电路的工作频率和组合逻辑电路传输延迟、触发器建立和保持时间、触发器传输延迟等时间密切相关
  - 建立时间容限=tclk-tffpd(max)-tcomb(max)-tsetup，>0
  - 保持时间容限=tffpd(min)+tcomb(min)-thold，>0

## 第四讲 典型时序逻辑部件设计

### 4.1 计数器
- 计数器是一种对外部激励信号进行总数统计的时序逻辑元件
- 一般从0开始计数，在达到最大计数值时输出一次计数完成信号，并重新开始计数
- 最大计数值为计数器的模
- 计数器的分类
  - 按时钟：同步、异步
  - 按计数方式：加法、减法、可逆
  - 按编码方式：二进制、十进制BCD码、循环码
  - 按进位方式：行波（串行）进位、并行进位

#### 异步行波加法计数器
- 利用T触发器实现，激励输入像波浪一样由低位向高位传递，每个时钟周期传送一次
- Qi+1总是在Qi由1变为0时开始改变状态
- 第n位状态变换要经过n×tTQ的延迟时间

#### 同步并行加法计数器
- 同步计数器中所有触发器共用同一个时钟信号，在时钟信号边沿到达后，所有触发器的输出同时发生变化
- 比行波（串行）加法计数器快得多

#### 二进制异步行波减法计数器
- 由4个上升沿触发的D触发器组成，Clear为复位（清0）信号

### 4.2 寄存器和寄存器堆
- 寄存器是用来暂存信息的逻辑部件
  - 寄存器可直接由若干个触发器组成
  - 寄存器通过三态门和总线互连
- 寄存器堆(Register File)：CPU内部用于暂存指令执行过程中的中间数据，也称通用寄存器组(General Purpose Register set，GPRs)
  - 由许多寄存器